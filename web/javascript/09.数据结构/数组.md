[TOC]
***

### 一、数组的应用

```JS
let arr = [1, 2, 3]
```
**优点：**
* 随机访问：可以通过下标随机访问数组中的任意位置上的数据

**缺点：**
* 对数据的删除和插入不是很友好

查找：根据下标随机访问的时间复杂度为O(1);
插入或删除：时间复杂度为O(n);

在js中的数组几乎是万能的，他不光可以作为一个普通数组使用，还可以作为栈或队列使用。

### 二、js数组的独特之处

> 我们知道在 JavaScript 中，可以在数组中保存不同类型值，并且数组可以动态增长，不像其它语言，例如 C，创建的时候要决定数组的大小，如果数组满了，就要重新申请内存空间。这是为什么喃？

JavaScript 中， JSArray 继承自 JSObject ，或者说它就是一个特殊的对象，内部是以 key-value 形式存储数据，所以 JavaScript 中的数组可以存放不同类型的值。它有两种存储方式，快数组与慢数组，初始化空数组时，使用快数组，快数组使用连续的内存空间，当数组长度达到最大时，JSArray 会进行动态的扩容，以存储更多的元素，相对慢数组，性能要好得多。当数组中 hole 太多时，会转变成慢数组，即以哈希表的方式（ key-value 的形式）存储数据，以节省内存空间。

#### 1.快数组（FastElements）
存储结构是 FixedArray ，并且数组长度 <= elements.length() ，push 或 pop 时可能会伴随着动态扩容或减容

FixedArray 是 V8 实现的一个类似于数组的类，它表示一段连续的内存，可以使用索引直接定位。新创建的空数组默认就是快数组。当数组满（数组的长度达到数组在内存中申请的内存容量最大值）的时候，继续 push 时， JSArray 会进行动态的扩容，以存储更多的元素。

#### 2.慢数组（SlowElements）
存储结构是 HashTable（哈希表），并且数组下标作为 key

慢数组以哈希表的形式存储在内存空间里，它不需要开辟连续的存储空间，但需要额外维护一个哈希表，与快数组相比，性能相对较差。

#### 3.什么时候会从 fast 转变为 slow
* 当加入的索引值 index 比当前容量 capacity 差值大于等于 1024 时（index - capacity >= 1024）
* 快数组新容量是扩容后的容量 3 倍之多时

例如：向快数组里增加一个大索引同类型值
```JS
var arr = [1, 2, 3]
arr[2000] = 10;
```
当往 arr 增加一个 2000 的索引时，arr 被转成慢数组。节省了大量的内存空间（从索引为 2 到索引为 2000）。

#### 4.什么时候会从 slow 转变为 fast 喃
* 当慢数组的元素可存放在快数组中且长度小于Smi::kMaxValue且对于快数组仅节省了50%的空间，则会转变为快数组
